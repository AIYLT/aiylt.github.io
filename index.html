<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- 性能优化 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="https://api.openai.com">
    <link rel="preconnect" href="https://api.linear.app">
    
    <!-- 监控和分析 -->
    <script>
        // 性能监控
        window.performance.mark('app-start');
        
        // 错误报告
        window.addEventListener('error', function(e) {
            if (window.O3Monitor) {
                window.O3Monitor.recordError(e.error, { context: 'global' });
            }
        });
        
        // 页面加载完成
        window.addEventListener('load', function() {
            window.performance.mark('app-loaded');
            console.log('🚀 O3 Validator with Linear Integration v2.0 已加载');
        });
    </script>

    <!-- 性能优化 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="https://api.openai.com">
    <link rel="preconnect" href="https://api.linear.app">
    
    <!-- 监控和分析 -->
    <script>
        // 性能监控
        window.performance.mark('app-start');
        
        // 错误报告
        window.addEventListener('error', function(e) {
            if (window.O3Monitor) {
                window.O3Monitor.recordError(e.error, { context: 'global' });
            }
        });
        
        // 页面加载完成
        window.addEventListener('load', function() {
            window.performance.mark('app-loaded');
            console.log('🚀 O3 Validator with Linear Integration v2.0 已加载');
        });
    </script>

    <!-- 性能优化 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="https://api.openai.com">
    <link rel="preconnect" href="https://api.linear.app">
    
    <!-- 监控和分析 -->
    <script>
        // 性能监控
        window.performance.mark('app-start');
        
        // 错误报告
        window.addEventListener('error', function(e) {
            if (window.O3Monitor) {
                window.O3Monitor.recordError(e.error, { context: 'global' });
            }
        });
        
        // 页面加载完成
        window.addEventListener('load', function() {
            window.performance.mark('app-loaded');
            console.log('🚀 O3 Validator with Linear Integration v2.0 已加载');
        });
    </script>

    <!-- 性能优化 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="preconnect" href="https://api.openai.com">
    <link rel="preconnect" href="https://api.linear.app">
    
    <!-- 监控和分析 -->
    <script>
        // 性能监控
        window.performance.mark('app-start');
        
        // 错误报告
        window.addEventListener('error', function(e) {
            if (window.O3Monitor) {
                window.O3Monitor.recordError(e.error, { context: 'global' });
            }
        });
        
        // 页面加载完成
        window.addEventListener('load', function() {
            window.performance.mark('app-loaded');
            console.log('🚀 O3 Validator with Linear Integration v2.0 已加载');
        });
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenAI o3-2025-04-16 模型验证器演示</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            margin-top: 10px;
            opacity: 0.9;
        }
        
        .demo-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .demo-section h2 {
            color: #2E7D32;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        
        .test-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background-color 0.3s;
        }
        
        .test-button:hover {
            background-color: #45a049;
        }
        
        .test-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-active {
            background-color: #4CAF50;
            animation: pulse 2s infinite;
        }
        
        .status-inactive {
            background-color: #f44336;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .info-box {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .conversation-container {
            margin-top: 20px;
            min-height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            background-color: #fafafa;
        }
        
        .validation-log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 12px;
        }
        
        .github-link {
            display: inline-block;
            background-color: #333;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        
        .github-link:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🔒 OpenAI o3-2025-04-16 模型验证器</h1>
        <p>强制验证机制 - 确保每次调用都使用正确的模型</p>
    </div>

    <div class="demo-section">
        <h2>📊 验证器状态</h2>
        <p>
            <span class="status-indicator status-active"></span>
            <strong>验证器状态：</strong> <span id="validator-status">正在启动...</span>
        </p>
        <p><strong>API端点：</strong> https://api.openai.com/v1/chat/completions</p>
        <p><strong>要求模型：</strong> o3-2025-04-16</p>
        <p><strong>验证次数：</strong> <span id="validation-count">0</span></p>
    </div>

    <div class="demo-section">
        <h2>🎯 功能演示</h2>
        <div class="info-box">
            <strong>💡 说明：</strong> 验证器会自动拦截所有OpenAI API调用，强制使用o3-2025-04-16模型，并在每次调用后显示验证结果。
        </div>
        
        <h3>模拟API调用测试</h3>
        <button class="test-button" onclick="simulateAPICall()">🧪 模拟成功调用</button>
        <button class="test-button" onclick="simulateFailedCall()">❌ 模拟失败调用</button>
        <button class="test-button" onclick="clearValidation()">🗑️ 清除验证记录</button>
        
        <div class="code-block">
// 模拟API调用代码
const response = await fetch('https://api.openai.com/v1/chat/completions', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer YOUR_API_KEY'
    },
    body: JSON.stringify({
        model: 'o3-2025-04-16',
        messages: [
            { role: 'user', content: '你好，请确认你是o3-2025-04-16模型' }
        ],
        temperature: 0,
        top_p: 0.8
    })
});
        </div>
    </div>

    <div class="demo-section">
        <h2>📋 验证日志</h2>
        <div class="validation-log" id="validation-log">
            <div>🔄 等待API调用...</div>
        </div>
    </div>

    <div class="demo-section">
        <h2>🎨 验证结果显示区域</h2>
        <div class="warning-box">
            <strong>⚠️ 注意：</strong> 验证结果将自动显示在此区域下方，包括技术验证区块和图像提示区块。
        </div>
        <div class="conversation-container" id="conversation-container">
            <p style="text-align: center; color: #666; font-style: italic;">
                验证结果将在这里显示...
            </p>
        </div>
    </div>

    <div class="demo-section">
        <h2>🚀 部署说明</h2>
        <h3>GitHub Pages 部署</h3>
        <div class="code-block">
1. 创建GitHub仓库: AIYLT/aiylt.github.io
2. 上传文件到actions目录:
   - actions/verify-o3-model-used.action.min.js
   - index.html
   - README.md

3. 在HTML页面中引入验证器:
   &lt;script src="actions/verify-o3-model-used.action.min.js"&gt;&lt;/script&gt;

4. 验证器将自动启动并拦截所有OpenAI API调用
        </div>
        
        <h3>集成到现有项目</h3>
        <div class="code-block">
// 在你的项目中引入验证器
import O3ModelValidator from './actions/verify-o3-model-used.action.min.js';

// 手动初始化（可选，通常会自动初始化）
const validator = new O3ModelValidator();

// 获取验证历史
const history = validator.getValidationHistory();
console.log('验证历史:', history);

// 获取最新验证结果
const latest = validator.getLatestValidation();
console.log('最新验证:', latest);
        </div>
        
        <a href="https://github.com/AIYLT/aiylt.github.io" class="github-link" target="_blank">
            📁 查看GitHub仓库
        </a>
    </div>

    <div class="demo-section">
        <h2>🔧 API规范</h2>
        <div class="info-box">
            <strong>📋 基于OpenAPI 3.1.0规范</strong><br>
            验证器严格按照用户提供的OpenAPI规范文件实现，确保完全兼容o3-2025-04-16模型的所有功能。
        </div>
        
        <h3>必须验证的字段</h3>
        <ul>
            <li><strong>model:</strong> 必须为 "o3-2025-04-16"</li>
            <li><strong>status:</strong> 必须为 HTTP 200 OK</li>
            <li><strong>usage:</strong> 必须包含完整的token统计信息</li>
            <li><strong>choices[0].message.role:</strong> 必须为 "assistant"</li>
            <li><strong>reasoning_tokens:</strong> o3模型特有的推理token统计</li>
        </ul>
    </div>

    <script src="actions/verify-o3-model-used.action.min.js"></script>
    <script>
        // 更新验证器状态显示
        function updateValidatorStatus() {
            const statusEl = document.getElementById('validator-status');
            const countEl = document.getElementById('validation-count');
            
            if (window.O3Validator) {
                statusEl.textContent = '✅ 已启动并监控中';
                statusEl.parentElement.querySelector('.status-indicator').className = 'status-indicator status-active';
                countEl.textContent = window.O3Validator.validation_results.length;
            } else {
                statusEl.textContent = '❌ 未启动';
                statusEl.parentElement.querySelector('.status-indicator').className = 'status-indicator status-inactive';
            }
        }
        
        // 添加日志
        function addLog(message, type = 'info') {
            const logEl = document.getElementById('validation-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span style="color: #666;">[${timestamp}]</span> ${message}`;
            logEl.appendChild(logEntry);
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        // 模拟成功的API调用
        async function simulateAPICall() {
            addLog('🔄 开始模拟API调用...');
            
            try {
                // 创建模拟的成功响应
                const mockResponse = {
                    id: "chatcmpl-" + Date.now(),
                    object: "chat.completion",
                    created: Math.floor(Date.now() / 1000),
                    model: "o3-2025-04-16",
                    choices: [{
                        index: 0,
                        message: {
                            role: "assistant",
                            content: "🎯 当前模型：OpenAI o3-2025-04-16\\n\\n验证成功！我正在使用o3-2025-04-16模型为您提供服务。"
                        },
                        finish_reason: "stop"
                    }],
                    usage: {
                        prompt_tokens: 25,
                        completion_tokens: 45,
                        total_tokens: 70,
                        completion_tokens_details: {
                            reasoning_tokens: 15
                        }
                    }
                };
                
                // 触发验证
                if (window.O3Validator) {
                    await window.O3Validator.validateResponse(mockResponse, 200);
                    addLog('✅ 模拟调用成功，验证通过');
                } else {
                    addLog('❌ 验证器未启动');
                }
                
            } catch (error) {
                addLog(`❌ 模拟调用失败: ${error.message}`);
            }
            
            updateValidatorStatus();
        }
        
        // 模拟失败的API调用
        async function simulateFailedCall() {
            addLog('🔄 开始模拟失败调用...');
            
            try {
                // 创建模拟的失败响应
                const mockResponse = {
                    id: "chatcmpl-" + Date.now(),
                    object: "chat.completion",
                    created: Math.floor(Date.now() / 1000),
                    model: "gpt-4", // 错误的模型
                    choices: [{
                        index: 0,
                        message: {
                            role: "assistant",
                            content: "这是一个错误的模型调用"
                        },
                        finish_reason: "stop"
                    }],
                    usage: {
                        prompt_tokens: 20,
                        completion_tokens: 10,
                        total_tokens: 30
                    }
                };
                
                // 触发验证
                if (window.O3Validator) {
                    try {
                        await window.O3Validator.validateResponse(mockResponse, 200);
                    } catch (error) {
                        addLog(`❌ 验证失败（预期的）: ${error.message}`);
                    }
                } else {
                    addLog('❌ 验证器未启动');
                }
                
            } catch (error) {
                addLog(`❌ 模拟失败调用出错: ${error.message}`);
            }
            
            updateValidatorStatus();
        }
        
        // 清除验证记录
        function clearValidation() {
            if (window.O3Validator) {
                window.O3Validator.reset();
                addLog('🗑️ 验证记录已清除');
            }
            document.getElementById('validation-log').innerHTML = '<div>🔄 等待API调用...</div>';
            updateValidatorStatus();
        }
        
        // 页面加载完成后初始化
        window.addEventListener('load', function() {
            setTimeout(updateValidatorStatus, 1000);
            addLog('🚀 验证器演示页面已加载');
        });
        
        // 定期更新状态
        setInterval(updateValidatorStatus, 5000);
    </script>
</body>
</html> 